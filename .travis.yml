---
sudo: required
language: python
python: "2.7"

dist: trusty

addons:
  apt:
    sources:
      - deadsnakes
    packages:
      - python2.4
      - python2.6
      - python3.5

before_install:
  - sudo apt-get update
  - sudo apt-get install -y python-pip
  - sudo apt-get install -y apt-transport-https ca-certificates
  - sudo apt-key adv --keyserver hkp://ha.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
  - echo 'deb https://apt.dockerproject.org/repo ubuntu-trusty main' | sudo tee /etc/apt/sources.list.d/docker.list
  - sudo apt-get update
  - sudo apt-get install -o Dpkg::Options::="--force-confdef" -y docker-engine
  - docker version
  - docker run --name centos7 -di centos:7 /bin/sh
  - docker run --name centos6 -di centos:6 /bin/sh
  - docker run --name centos5 -di centos:5 /bin/sh
  - docker exec centos7 yum makecache
  - docker exec centos7 yum install -y python ca-certificates authconfig
  - docker exec centos6 yum makecache
  - docker exec centos6 yum install -y python ca-certificates authconfig
  - docker exec centos5 yum makecache
  - docker exec centos5 yum install -y python ca-certificates authconfig

install:
  - pip install ansible
  - pip install ansible-testing
  - ansible --version

script:
  - python2.4 -m compileall -fq library
  - python2.6 -m compileall -fq library
  - python2.7 -m compileall -fq library
  - python3.5 -m compileall -fq library
  - ansible-validate-modules library
  #- ./test-docs.sh core
